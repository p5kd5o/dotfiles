## bashrc.d/history : functions to manipulate shell command history


## Synchronizes current shell history with the histfile
_sync_history() {
  ## Honor both 'histappend' and 'erasedups'
  if [[ :${HISTCONTROL-}: = *:erasedups:* ]]; then
    if [[ :${BASHOPTS-}:  = *:histappend:* ]]; then
      history -a  ## Append new history
      history -c  ## Clear history
      history -r  ## Read history (shared state)
    else
      history -n            ## Read new history
      shopt -s histappend   ## Enable 'histappend' (shared state)
    fi
  
    ## Trigger duplicate removal by writing the histfile 
    history -w
  
    ## Clear the history buffer
    history -c

    ## Re-read history from updated histfile
    history -r
  fi
}



## vi:ft=sh:et:sts=2:sw=2:ts=8
